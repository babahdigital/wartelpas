<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8">
<title>Audit Penjualan & Voucher</title>
<style>
    /* BASE STYLES */
    body { 
        font-family: 'Segoe UI', Arial, sans-serif; /* Font lebih modern */
        color: #111; 
        margin: 0; 
        padding: 12mm; /* Padding layar normal */
    }
    h1 { margin: 0 0 4mm 0; font-size: 16px; }
    .sub { font-size: 11px; color: #444; margin-bottom: 6mm; } /* Warna dipertegas */

    /* GRID SYSTEM */
    .summary-grid { 
        display: grid; 
        grid-template-columns: repeat(4, minmax(0, 1fr)); 
        gap: 6px; 
        margin-bottom: 8mm; 
        page-break-inside: avoid; /* Mencegah kotak terpotong saat print */
    }
    .summary-card { 
        border: 1px solid #ddd; 
        border-radius: 4px; 
        padding: 6px; 
        background-color: #fff;
    }
    .summary-title { 
        font-size: 10px; 
        color: #444; 
        text-transform: uppercase; 
        letter-spacing: .4px; 
        font-weight: 600;
    }
    .summary-value { font-size: 13px; font-weight: bold; margin-top: 2px; }

    /* SECTIONS */
    .section { margin-bottom: 6mm; }
    .section-title { 
        font-weight: 700; 
        font-size: 12px; 
        margin: 4mm 0 2mm; 
        border-bottom: 1px solid #eee; /* Garis pemisah visual */
        padding-bottom: 2px;
    }

    /* TABLES */
    table { width: 100%; border-collapse: collapse; font-size: 11px; }
    th, td { border: 1px solid #ccc; padding: 5px 6px; text-align: left; } /* Border dipertegas jadi #ccc */
    th { background: #f0f0f0; font-weight: bold; }
    
    /* UTILITIES */
    .text-right { text-align: right; }
    .text-center { text-align: center; }
    .text-red { color: #c0392b; }
    .muted { color: #444; }

    .avoid-break { 
        break-inside: avoid; 
        page-break-inside: avoid; 
    }

    .print-color {
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
    }
    
    /* SIGNATURE BLOCK */
    .signature-wrapper {
        margin-top: 30px; 
        display: flex; 
        justify-content: space-between; 
        gap: 16px;
        page-break-inside: avoid; /* Mencegah tanda tangan terbelah antar halaman */
    }

    /* TOOLBAR (SCREEN ONLY) */
    .toolbar { margin-bottom: 10px; display: flex; gap: 8px; flex-wrap: wrap; }
    .btn { 
        padding: 8px 12px; 
        border: 1px solid #888; 
        background: #f2f2f2; 
        cursor: pointer; 
        border-radius: 4px; 
        font-size: 12px; 
        font-weight: bold;
    }
    .btn:hover { background: #e0e0e0; }

    /* PRINT CONFIGURATION - CRITICAL UPDATE */
    @page { 
        margin: 10mm; /* Margin kertas fisik yang aman */
        size: auto; 
    }

    @media print {
        body { 
            padding: 0; /* Hapus padding body agar tidak dobel margin */
            margin: 0;
            color: #000;
            -webkit-print-color-adjust: exact; /* WAJIB: Paksa cetak background color */
            print-color-adjust: exact;
        }
        .toolbar { display: none; }
        
        /* Pastikan warna teks hitam pekat untuk printer dot-matrix/thermal */
        .sub, .summary-title, .muted { color: #000; } 
        th { background-color: #f0f0f0 !important; }
        
        /* Hilangkan shadow atau elemen dekoratif berat jika ada */
        .summary-card { break-inside: avoid; }
        .avoid-break { break-inside: avoid; page-break-inside: avoid; }
    }
</style>
</head>
<body>
  
  <!-- Toolbar Navigasi -->
  <div class="toolbar">
      <button class="btn" onclick="window.print()">üñ®Ô∏è Print / Download PDF</button>
      <button class="btn" onclick="shareReport()">üîó Share</button>
  </div>

  <!-- Header Laporan -->
  <div style="border-bottom: 2px solid #000; padding-bottom: 10px; margin-bottom: 20px;">
      <h1 style="margin:0;">Laporan Audit Keuangan</h1>
      <div class="sub" style="margin-top:5px;">
          Periode: 29-01-2026 | Mode: HARIAN
      </div>
  </div>

  <!-- Status Box - Dengan Background Color Adjust -->
    <div class="print-color avoid-break" style="border: 2px solid #15803d; background-color: #dcfce7; padding: 15px; border-radius: 4px; margin-bottom: 20px;">
      <table style="width:100%; border:none;">
          <tr>
              <td style="border:none; padding:0;">
                  <div style="font-size:10px; color:#14532d; text-transform:uppercase; font-weight:bold;">Status Audit</div>
                  <div style="font-size:18px; font-weight:bold; color:#15803d; margin-top:4px;">
                      LEBIH SETOR
                  </div>
              </td>
              <td style="border:none; padding:0; text-align:right;">
                  <div style="font-size:10px; color:#14532d; text-transform:uppercase; font-weight:bold;">Total Selisih</div>
                  <div style="font-size:18px; font-weight:bold; color:#15803d; margin-top:4px;">
                      Rp 40.000
                  </div>
              </td>
          </tr>
      </table>
  </div>

  <!-- Tabel Rekonsiliasi -->
  <div class="section-title">Rekonsiliasi Pendapatan (Sistem vs Fisik)</div>
  <table>
      <thead>
        <tr>
          <th style="width:40%;">Keterangan</th>
          <th style="width:30%; text-align:right;">Sistem (Target)</th>
          <th style="width:30%; text-align:right;">Fisik (Aktual)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Omzet Penjualan (Gross)</td>
          <td class="text-right">Rp 3.935.000</td>
          <td class="text-center" style="background:#eee;">-</td>
        </tr>
        <tr>
          <td>(-) Potongan (Rusak/Invalid)</td>
          <td class="text-right text-red">(Rp 160.000)</td>
          <td class="text-center" style="background:#eee;">-</td>
        </tr>
        
        <tr class="bold" style="background:#f9f9f9; font-weight:bold;">
          <td>(=) Pendapatan Bersih (Net)</td>
          <td class="text-right">Rp 3.775.000</td>
          <td class="text-right" style="border:2px solid #000; font-weight:bold;">Rp 4.125.000</td>
        </tr>
        
        <tr>
          <td>(-) Pengeluaran Operasional</td>
          <td class="text-center" style="background:#eee;">-</td>
          <td class="text-right text-red">(Rp 0)</td>
        </tr>
        
        <tr>
          <td>(-) Pengembalian</td>
          <td class="text-center" style="background:#eee;">-</td>
          <td class="text-right" style="color:#6c5ce7; font-weight:bold;">(Rp 310.000)</td>
        </tr>
        
        <tr class="bold" style="border-top: 2px solid #333;">
          <td style="font-weight:bold;">(=) Total Uang Disetor</td>
          <td class="text-center" style="background:#eee;">-</td>
          <td class="text-right" style="font-weight:bold; font-size:12px;">Rp 3.815.000</td>
        </tr>
      </tbody>
  </table>

  <!-- Kartu Rincian -->
  <div class="section-title">Rincian Perhitungan</div>
    <div class="summary-grid" style="grid-template-columns: repeat(3, minmax(0, 1fr));">
      <div class="summary-card">
          <div class="summary-title">Setoran Bersih (Cash)</div>
          <div class="summary-value">Rp 3.815.000</div>
      </div>
      <div class="summary-card">
          <div class="summary-title" style="color:#6c5ce7;">Pengembalian</div>
          <div class="summary-value" style="color:#6c5ce7;">Rp 310.000</div>
      </div>
      <div class="summary-card">
          <div class="summary-title">Target Sistem (Audit)</div>
          <div class="summary-value">Rp 3.775.000</div>
      </div>
      <div class="summary-card">
          <div class="summary-title">Target Sistem (Global)</div>
          <div class="summary-value">Rp 3.775.000</div>
      </div>
      <div class="summary-card">
          <div class="summary-title">Selisih Uang</div>
          <div class="summary-value" style="color:#15803d;">Rp 40.000</div>
      </div>
      <div class="summary-card">
          <div class="summary-title">Selisih Qty</div>
          <div class="summary-value" style="color:#15803d;">49</div>
      </div>
  </div>

  <!-- Statistik -->
  <div class="section-title">Statistik Keuangan & Insiden (Real-Time)</div>
  <div class="summary-grid" style="grid-template-columns: repeat(3, 1fr);">
      <div class="summary-card">
          <div class="summary-title">Total Transaksi</div>
          <div class="summary-value">535</div>
          <div style="font-size:10px;color:#444;">(Final + Live)</div>
      </div>
      <div class="summary-card">
          <div class="summary-title">Pendapatan Kotor (Gross)</div>
          <div class="summary-value">Rp 3.935.000</div>
      </div>
      <div class="summary-card">
          <div class="summary-title" style="color:#c0392b;">Total Voucher Rusak/Invalid</div>
          <div class="summary-value" style="color:#c0392b;">Rp 160.000</div>
          <div style="font-size:10px;color:#c0392b;">(Mengurangi Setoran)</div>
      </div>
  </div>

  <!-- Catatan & Keterangan -->
  <div class="print-color avoid-break" style="margin-top:8px; padding:8px; border:1px solid #ccc; background:#f8fafc; font-size:11px; color:#333;">
      <strong>Catatan Refund:</strong> Total refund tercatat Rp 310.000.
      <div style="margin-top:6px;">
          <strong>Catatan Selisih (setelah refund):</strong>
          <ul style="margin:6px 0 0 16px; padding:0;">
              <li>
                  Blok BLOK-E: Refund Rp 120.000 (Dikembalikan Ke Blok) ‚Äî Selisih Rp 40.000
              </li>
          </ul>
      </div>
  </div>

  <!-- Analisa Audit Total (Bulanan/Tahunan) -->
  <div class="section-title">Analisa Audit Total (Bulanan/Tahunan)</div>
  <div class="summary-grid avoid-break" style="grid-template-columns: repeat(3, minmax(0, 1fr));">
      <div class="summary-card">
          <div class="summary-title">Total Setoran Bersih Periode</div>
          <div class="summary-value">Rp 83.450.000</div>
      </div>
      <div class="summary-card">
          <div class="summary-title" style="color:#6c5ce7;">Total Refund Periode</div>
          <div class="summary-value" style="color:#6c5ce7;">Rp 1.250.000</div>
      </div>
      <div class="summary-card">
          <div class="summary-title">Selisih Uang (Total)</div>
          <div class="summary-value" style="color:#15803d;">Rp 320.000</div>
      </div>
  </div>
  <div class="print-color avoid-break" style="margin-top:6px; padding:8px; border:1px solid #e5e7eb; background:#f8fafc; font-size:11px; color:#333;">
      <strong>Catatan:</strong> Untuk mode bulanan/tahunan, seluruh angka di atas merupakan akumulasi periode yang dipilih.
  </div>

    <div class="print-color avoid-break" style="margin-top:10px; padding:10px; border:1px dashed #999; background:#f9f9f9; font-size:11px; color:#444;">
      <strong>Cara Membaca Rekonsiliasi:</strong><br>
      1. <b>Omzet (Gross)</b>: Total nilai transaksi yang sempat terjadi (termasuk voucher Rusak/Invalid).<br>
      2. <b>(-) Potongan</b>: Nilai uang yang hilang karena voucher Rusak/Invalid.<br>
      3. <b>(+) Pemulihan</b>: Nilai uang yang kembali sah karena diganti voucher Retur.<br>
      4. <b>(=) Net</b>: Uang yang wajib ada di laci.
  </div>

  <!-- Tanda Tangan -->
    <div class="signature-wrapper avoid-break">
      <div style="width:30%; text-align:center;">
        Dibuat Oleh (Operator),
        <div style="margin-top:80px; border-bottom:1px solid #000; margin-bottom:10px;"></div>
        <small>( tanda tangan & nama jelas )</small>
      </div>
      <div style="width:30%; text-align:center;">
        Diperiksa Oleh (Admin),
        <div style="margin-top:80px; border-bottom:1px solid #000; margin-bottom:10px;"></div>
        <small>( tanda tangan & nama jelas )</small>
      </div>
  </div>

    <div style="margin-top:20px; font-size:10px; color:#444; text-align:center; font-style:italic;">
      Dicetak oleh Sistem Wartelpas pada 31-01-2026 08:32:35
  </div>

  <script>
    function shareReport(){
        if (navigator.share) {
            navigator.share({ title: 'Laporan Audit Keuangan', url: window.location.href });
        } else {
            window.prompt('Salin link laporan:', window.location.href);
        }
    }
  </script>
</body>
</html>