<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rekap Laporan Penjualan - Bulanan & Tahunan</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* Styling khusus untuk cetak agar sesuai dengan kertas A4 */
        @media print {
            @page { size: A4 landscape; margin: 10mm; }
            body { -webkit-print-color-adjust: exact; print-color-adjust: exact; font-size: 9pt; }
            .no-print { display: none !important; }
            .page-break { page-break-before: always; }
            /* Sembunyikan tab yang tidak aktif saat dicetak */
            .hidden-print { display: none !important; }
            table { width: 100%; border-collapse: collapse; }
            th, td { border: 1px solid #000 !important; padding: 4px; }
            /* Memastikan header tabel berulang di halaman baru jika tabel panjang */
            thead { display: table-header-group; }
            .bg-slate-800 { background-color: #1e293b !important; color: white !important; }
            .bg-gray-100 { background-color: #f3f4f6 !important; }
        }
        
        /* Utility Custom */
        .currency { text-align: right; white-space: nowrap; font-family: 'Courier New', Courier, monospace; }
        .center-text { text-align: center; }
        .bg-header { background-color: #f3f4f6; font-weight: bold; text-transform: uppercase; font-size: 0.75rem; }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 p-4 min-h-screen font-sans">

    <!-- Kontrol Navigasi (Tidak tercetak) -->
    <div class="max-w-7xl mx-auto mb-6 no-print flex justify-between items-center bg-white p-4 rounded-lg shadow">
        <div>
            <h1 class="text-xl font-bold text-gray-700">Sistem Rekapitulasi Laporan</h1>
            <p class="text-sm text-gray-500">Pilih jenis laporan untuk ditampilkan</p>
        </div>
        <div class="flex gap-2">
            <button onclick="showTab('bulanan')" id="btn-bulanan" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 font-medium transition shadow">
                <i class="fas fa-calendar-alt mr-2"></i>Rekap Bulanan
            </button>
            <button onclick="showTab('tahunan')" id="btn-tahunan" class="px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 font-medium transition">
                <i class="fas fa-calendar mr-2"></i>Rekap Tahunan
            </button>
            <button onclick="window.print()" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 font-medium transition shadow ml-4">
                <i class="fas fa-print mr-2"></i>Cetak PDF
            </button>
        </div>
    </div>

    <!-- ========================================= -->
    <!-- BAGIAN 1: REKAP BULANAN -->
    <!-- Konsep: Baris adalah TANGGAL, Kolom adalah Agregasi Blok -->
    <!-- ========================================= -->
    <div id="view-bulanan" class="view-section max-w-7xl mx-auto bg-white p-8 rounded shadow-lg print:shadow-none print:p-0">
        
        <!-- Header Laporan -->
        <div class="border-b-2 border-gray-800 pb-4 mb-4">
            <div class="flex justify-between items-end">
                <div>
                    <h2 class="text-2xl font-bold uppercase tracking-wide">Rekap Laporan Penjualan (Bulanan)</h2>
                    <p class="text-sm mt-1">Periode: <span class="font-bold">Januari 2026</span> | Dicetak: <span class="print-date"></span></p>
                </div>
                <div class="text-right">
                    <div class="text-xs text-gray-500">Total Pendapatan Bersih</div>
                    <div class="text-xl font-bold text-green-700">Rp 96.450.000</div>
                </div>
            </div>
        </div>

        <!-- Ringkasan Atas (Sesuai gaya PDF Harian tapi akumulasi) -->
        <div class="grid grid-cols-4 gap-4 mb-6 text-sm border p-4 bg-gray-50 rounded print:border-gray-300">
            <div>
                <span class="block text-gray-500 text-xs uppercase">Total Voucher Terjual</span>
                <span class="font-bold text-lg">14.500</span>
            </div>
            <div>
                <span class="block text-gray-500 text-xs uppercase">Total Bandwidth</span>
                <span class="font-bold text-lg">1.4 TB</span>
            </div>
            <div>
                <span class="block text-gray-500 text-xs uppercase">Insiden (Rusak/Spam)</span>
                <span class="font-bold text-lg text-red-600">45 / 12</span>
            </div>
            <div>
                <span class="block text-gray-500 text-xs uppercase">Total Device (WR/KM)</span>
                <span class="font-bold text-lg">450 / 320</span>
            </div>
        </div>

        <!-- Tabel Utama Bulanan -->
        <div class="overflow-x-auto">
            <table class="w-full text-sm border border-gray-300">
                <thead>
                    <tr class="bg-gray-800 text-white text-center">
                        <th rowspan="2" class="p-2 w-12 border border-gray-600">Tgl</th>
                        <th colspan="2" class="p-2 border border-gray-600">Keuangan</th>
                        <th colspan="2" class="p-2 border border-gray-600">Voucher</th>
                        <th colspan="5" class="p-2 border border-gray-600">Rincian Device & Status</th>
                        <th rowspan="2" class="p-2 border border-gray-600">Bandwidth</th>
                    </tr>
                    <tr class="bg-gray-100 text-gray-800 text-xs uppercase text-center font-bold">
                        <th class="p-2 border">Gross System</th>
                        <th class="p-2 border">Net Audit</th> <!-- Mengacu pada 'Net Audit' di PDF -->
                        <th class="p-2 border">Qty</th>
                        <th class="p-2 border">Rusak</th>
                        <th class="p-2 border bg-yellow-50">RS</th> <!-- Rusak -->
                        <th class="p-2 border bg-yellow-50">SP</th> <!-- Spam -->
                        <th class="p-2 border bg-blue-50">WR</th> <!-- Wartel -->
                        <th class="p-2 border bg-blue-50">KM</th> <!-- Kamtib -->
                        <th class="p-2 border bg-green-50">HP Aktif</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Contoh Data Baris 1: Diambil dari PDF Harian Tanggal 20 -->
                    <tr class="hover:bg-gray-50 text-center">
                        <td class="p-2 border font-bold">20</td>
                        <td class="p-2 border currency text-gray-600">2.925.000</td>
                        <td class="p-2 border currency font-bold text-black">2.925.000</td>
                        <td class="p-2 border">441</td>
                        <td class="p-2 border text-red-500">0</td>
                        <td class="p-2 border">1</td> <!-- RS -->
                        <td class="p-2 border">2</td> <!-- SP -->
                        <td class="p-2 border">8</td> <!-- WR -->
                        <td class="p-2 border">0</td> <!-- KM -->
                        <td class="p-2 border font-bold">5</td> <!-- HP Aktif -->
                        <td class="p-2 border text-xs">42.5 GB</td>
                    </tr>
                    
                    <!-- Contoh Data Baris 2: Diambil dari PDF Harian Tanggal 23 -->
                    <tr class="hover:bg-gray-50 text-center">
                        <td class="p-2 border font-bold">23</td>
                        <td class="p-2 border currency text-gray-600">3.310.000</td>
                        <td class="p-2 border currency font-bold text-black">3.205.000</td> <!-- Ada selisih audit di PDF -->
                        <td class="p-2 border">470</td>
                        <td class="p-2 border text-red-500">3</td>
                        <td class="p-2 border">3</td> <!-- RS -->
                        <td class="p-2 border">0</td> <!-- SP -->
                        <td class="p-2 border">19</td> <!-- WR -->
                        <td class="p-2 border">17</td> <!-- KM -->
                        <td class="p-2 border font-bold">36</td>
                        <td class="p-2 border text-xs">49.6 GB</td>
                    </tr>

                    <!-- Filler Rows untuk ilustrasi -->
                    <tr class="hover:bg-gray-50 text-center text-gray-400 italic">
                        <td class="p-2 border">...</td>
                        <td class="p-2 border">...</td>
                        <td class="p-2 border">...</td>
                        <td class="p-2 border">...</td>
                        <td class="p-2 border">...</td>
                        <td class="p-2 border">...</td>
                        <td class="p-2 border">...</td>
                        <td class="p-2 border">...</td>
                        <td class="p-2 border">...</td>
                        <td class="p-2 border">...</td>
                        <td class="p-2 border">...</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr class="bg-gray-800 text-white font-bold text-center text-sm">
                        <td class="p-2 border">TOTAL</td>
                        <td class="p-2 border currency">98.500.000</td>
                        <td class="p-2 border currency">96.450.000</td>
                        <td class="p-2 border">14.500</td>
                        <td class="p-2 border text-red-300">45</td>
                        <td class="p-2 border">45</td>
                        <td class="p-2 border">12</td>
                        <td class="p-2 border">450</td>
                        <td class="p-2 border">320</td>
                        <td class="p-2 border">850</td>
                        <td class="p-2 border">1.4 TB</td>
                    </tr>
                </tfoot>
            </table>
        </div>
        
        <!-- Keterangan Kaki (Penting sesuai PDF) -->
        <div class="mt-4 text-xs text-gray-500 italic">
            <p><strong>Keterangan Kode:</strong> RS = Rusak, SP = Spam, WR = Wartel, KM = Kamtib.</p>
            <p>Catatan: Data rekap bulanan ini adalah agregasi dari laporan harian. Selisih audit telah diperhitungkan dalam kolom Net Audit.</p>
        </div>
    </div>


    <!-- ========================================= -->
    <!-- BAGIAN 2: REKAP TAHUNAN (PROFESSIONAL VERSION) -->
    <!-- Konsep: Helikopter View (Tren, Rata-rata, dan Kebocoran/Selisih) -->
    <!-- ========================================= -->
    <div id="view-tahunan" class="view-section hidden max-w-7xl mx-auto bg-white p-8 rounded shadow-lg print:shadow-none print:p-0">
        
        <!-- Header Laporan -->
        <div class="border-b-2 border-gray-800 pb-4 mb-4">
            <div class="flex justify-between items-end">
                <div>
                    <h2 class="text-2xl font-bold uppercase tracking-wide">Rekap Laporan Penjualan (Tahunan)</h2>
                    <p class="text-sm mt-1">Tahun Buku: <span class="font-bold">2026</span> | Dicetak: <span class="print-date"></span></p>
                </div>
                <!-- Summary Card Tahunan -->
                <div class="flex gap-4 text-right">
                    <div>
                        <div class="text-[10px] uppercase text-gray-500 font-bold">Total Transaksi</div>
                        <div class="text-lg font-bold text-gray-800">178.450 Qty</div>
                    </div>
                    <div>
                        <div class="text-[10px] uppercase text-gray-500 font-bold">Total Pendapatan Bersih</div>
                        <div class="text-lg font-bold text-blue-800">Rp 1.150.400.000</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dashboard Mini Tahunan -->
        <div class="grid grid-cols-5 gap-2 mb-6 text-sm">
            <div class="bg-blue-50 p-3 rounded border border-blue-100">
                <div class="text-xs text-blue-600 font-bold uppercase">Avg Sales/Hari</div>
                <div class="text-xl font-bold">488 <span class="text-xs font-normal text-gray-500">voucher</span></div>
            </div>
            <div class="bg-green-50 p-3 rounded border border-green-100">
                <div class="text-xs text-green-600 font-bold uppercase">Device Aktif (Avg)</div>
                <div class="text-xl font-bold">45 <span class="text-xs font-normal text-gray-500">unit</span></div>
            </div>
            <div class="bg-red-50 p-3 rounded border border-red-100">
                <div class="text-xs text-red-600 font-bold uppercase">Total Selisih Audit</div>
                <div class="text-xl font-bold text-red-700">- Rp 2.450.000</div>
            </div>
             <div class="bg-yellow-50 p-3 rounded border border-yellow-100">
                <div class="text-xs text-yellow-600 font-bold uppercase">Total Insiden (RS+SP)</div>
                <div class="text-xl font-bold">142 <span class="text-xs font-normal text-gray-500">kasus</span></div>
            </div>
            <div class="bg-gray-50 p-3 rounded border border-gray-200">
                <div class="text-xs text-gray-600 font-bold uppercase">Total Bandwidth</div>
                <div class="text-xl font-bold">18.5 TB</div>
            </div>
        </div>

        <!-- Tabel Utama Tahunan -->
        <div class="overflow-x-auto">
            <table class="w-full text-sm border border-gray-300">
                <thead>
                    <tr class="bg-gray-800 text-white text-center text-xs uppercase font-bold">
                        <th rowspan="2" class="p-2 border border-gray-600 w-24">Bulan</th>
                        <th colspan="3" class="p-2 border border-gray-600 bg-gray-700">Keuangan (Financial)</th>
                        <th colspan="2" class="p-2 border border-gray-600 bg-gray-700">Produktivitas</th>
                        <th colspan="4" class="p-2 border border-gray-600 bg-gray-700">Kesehatan Operasional (Total)</th>
                    </tr>
                    <tr class="bg-gray-100 text-gray-800 text-xs uppercase text-center font-bold">
                        <!-- Keuangan -->
                        <th class="p-2 border w-32">Gross System</th>
                        <th class="p-2 border w-32">Net Audit</th>
                        <th class="p-2 border w-24 text-red-700">Selisih</th>
                        
                        <!-- Produktivitas -->
                        <th class="p-2 border w-16">Total Qty</th>
                        <th class="p-2 border w-16 bg-blue-50">Avg/Hari</th>
                        
                        <!-- Operasional -->
                        <th class="p-2 border w-12 bg-yellow-50" title="Rusak">RS</th>
                        <th class="p-2 border w-12 bg-yellow-50" title="Spam">SP</th>
                        <th class="p-2 border w-12 bg-blue-50" title="Wartel">WR</th>
                        <th class="p-2 border w-12 bg-blue-50" title="Kamtib">KM</th>
                    </tr>
                </thead>
                <tbody class="text-gray-700">
                    <!-- Januari -->
                    <tr class="hover:bg-gray-50 text-center text-xs md:text-sm">
                        <td class="p-2 border font-bold text-left">Januari</td>
                        <td class="p-2 border currency text-gray-500">98.500.000</td>
                        <td class="p-2 border currency font-bold text-black">96.450.000</td>
                        <td class="p-2 border currency text-red-600 font-bold bg-red-50">-2.050.000</td>
                        
                        <td class="p-2 border font-bold">14.500</td>
                        <td class="p-2 border bg-blue-50">467</td>
                        
                        <td class="p-2 border bg-yellow-50">45</td>
                        <td class="p-2 border bg-yellow-50">12</td>
                        <td class="p-2 border bg-blue-50">450</td>
                        <td class="p-2 border bg-blue-50">320</td>
                    </tr>
                    
                    <!-- Februari (Estimasi) -->
                    <tr class="hover:bg-gray-50 text-center text-xs md:text-sm">
                        <td class="p-2 border font-bold text-left">Februari</td>
                        <td class="p-2 border currency text-gray-500">92.100.000</td>
                        <td class="p-2 border currency font-bold text-black">91.800.000</td>
                        <td class="p-2 border currency text-red-600 font-bold bg-red-50">-300.000</td>
                        
                        <td class="p-2 border font-bold">13.200</td>
                        <td class="p-2 border bg-blue-50">471</td>
                        
                        <td class="p-2 border bg-yellow-50">10</td>
                        <td class="p-2 border bg-yellow-50">5</td>
                        <td class="p-2 border bg-blue-50">410</td>
                        <td class="p-2 border bg-blue-50">290</td>
                    </tr>

                    <!-- Maret -->
                     <tr class="hover:bg-gray-50 text-center text-xs md:text-sm">
                        <td class="p-2 border font-bold text-left">Maret</td>
                        <td class="p-2 border currency text-gray-500">--</td>
                        <td class="p-2 border currency font-bold text-black">--</td>
                        <td class="p-2 border currency text-gray-400">--</td>
                        <td class="p-2 border">--</td>
                        <td class="p-2 border bg-blue-50">--</td>
                        <td class="p-2 border bg-yellow-50">--</td>
                        <td class="p-2 border bg-yellow-50">--</td>
                        <td class="p-2 border bg-blue-50">--</td>
                        <td class="p-2 border bg-blue-50">--</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr class="bg-gray-800 text-white font-bold text-center text-xs uppercase">
                        <td class="p-2 border text-left">TOTAL YTD</td>
                        <td class="p-2 border currency text-gray-300">190.600.000</td>
                        <td class="p-2 border currency text-white text-sm">188.250.000</td>
                        <td class="p-2 border currency text-red-300">-2.350.000</td>
                        
                        <td class="p-2 border">27.700</td>
                        <td class="p-2 border text-blue-200">469 (Avg)</td>
                        
                        <td class="p-2 border text-yellow-200">55</td>
                        <td class="p-2 border text-yellow-200">17</td>
                        <td class="p-2 border text-blue-200">860</td>
                        <td class="p-2 border text-blue-200">610</td>
                    </tr>
                </tfoot>
            </table>
        </div>
        
        <!-- Grafik Indikator (Print Friendly CSS Bar) -->
        <div class="mt-8 grid grid-cols-2 gap-8 break-inside-avoid">
            <!-- Grafik Keuangan -->
            <div class="border p-4 rounded bg-gray-50">
                <h3 class="font-bold mb-4 text-xs uppercase border-b pb-2 text-gray-600">Tren Pendapatan Bersih (Juta Rp)</h3>
                <div class="flex items-end h-32 gap-4 pl-2 border-l border-b border-gray-400">
                    <!-- Jan -->
                    <div class="w-10 bg-blue-600 rounded-t relative group h-[80%]">
                        <span class="absolute -top-5 w-full text-center text-[10px] font-bold">96.4</span>
                        <span class="absolute -bottom-6 w-full text-center text-[10px]">Jan</span>
                    </div>
                    <!-- Feb -->
                    <div class="w-10 bg-blue-600 rounded-t relative group h-[76%]">
                        <span class="absolute -top-5 w-full text-center text-[10px] font-bold">91.8</span>
                        <span class="absolute -bottom-6 w-full text-center text-[10px]">Feb</span>
                    </div>
                    <!-- Mar Empty -->
                    <div class="w-10 bg-gray-200 rounded-t relative group h-1">
                        <span class="absolute -bottom-6 w-full text-center text-[10px] text-gray-400">Mar</span>
                    </div>
                </div>
            </div>

            <!-- Grafik Masalah (Insiden) -->
            <div class="border p-4 rounded bg-gray-50">
                <h3 class="font-bold mb-4 text-xs uppercase border-b pb-2 text-gray-600">Tren Insiden (Rusak + Spam)</h3>
                <div class="flex items-end h-32 gap-4 pl-2 border-l border-b border-gray-400">
                    <!-- Jan -->
                    <div class="w-10 bg-red-500 rounded-t relative group h-[60%]">
                        <span class="absolute -top-5 w-full text-center text-[10px] font-bold text-red-600">57</span>
                        <span class="absolute -bottom-6 w-full text-center text-[10px]">Jan</span>
                    </div>
                    <!-- Feb -->
                    <div class="w-10 bg-green-500 rounded-t relative group h-[15%]">
                        <span class="absolute -top-5 w-full text-center text-[10px] font-bold text-green-600">15</span>
                        <span class="absolute -bottom-6 w-full text-center text-[10px]">Feb</span>
                    </div>
                     <!-- Mar Empty -->
                    <div class="w-10 bg-gray-200 rounded-t relative group h-1">
                        <span class="absolute -bottom-6 w-full text-center text-[10px] text-gray-400">Mar</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Script Sederhana untuk Tab Switching
        function showTab(tabName) {
            // Sembunyikan semua section
            document.querySelectorAll('.view-section').forEach(el => {
                el.classList.add('hidden');
                el.classList.add('hidden-print'); // Tambahkan class hidden-print
            });

            // Reset tombol
            document.getElementById('btn-bulanan').className = "px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 font-medium transition shadow";
            document.getElementById('btn-tahunan').className = "px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 font-medium transition shadow";

            // Tampilkan yang dipilih
            if(tabName === 'bulanan') {
                const el = document.getElementById('view-bulanan');
                el.classList.remove('hidden');
                el.classList.remove('hidden-print'); // Hapus class hidden-print agar tercetak
                
                document.getElementById('btn-bulanan').className = "px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 font-medium transition shadow";
            } else {
                const el = document.getElementById('view-tahunan');
                el.classList.remove('hidden');
                el.classList.remove('hidden-print'); // Hapus class hidden-print agar tercetak

                document.getElementById('btn-tahunan').className = "px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 font-medium transition shadow";
            }
        }

        // Set tanggal cetak otomatis
        const now = new Date();
        document.querySelectorAll('.print-date').forEach(el => {
            el.innerText = now.toLocaleString('id-ID');
        });
    </script>
</body>
</html>