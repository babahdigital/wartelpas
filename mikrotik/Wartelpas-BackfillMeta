:global backfillMetaLock;
:if ([:typeof $backfillMetaLock] = "nothing") do={ :set backfillMetaLock false; }
:if ($backfillMetaLock = true) do={ :log warning "BACKFILL META: masih berjalan, skip"; :return; }
:set backfillMetaLock true;

:local url "http://wartelpas.sobigidul.net/report/laporan/services/backfill_meta.php?session=S3c7x9_LB&key=kX8gerJCDnsEn3GWbk5FCRHfpujZBpja2O3lbHvToWE=";

:do {
 /tool fetch url=$url keep-result=no;
 :log info "BACKFILL META: OK (2m)";
} on-error={
 :log warning "BACKFILL META: Gagal koneksi";
}

:set backfillMetaLock false;

# --- TODO WA SUMMARY (contoh scheduler) ---
:global todoWaLock;
:if ([:typeof $todoWaLock] = "nothing") do={ :set todoWaLock false; }
:if ($todoWaLock = true) do={ :log warning "TODO WA: masih berjalan, skip"; :return; }
:set todoWaLock true;

:local todoUrl "http://wartelpas.sobigidul.net/tools/wa_todo_summary.php";

:do {
 /tool fetch url=$todoUrl keep-result=no;
 :log info "TODO WA: OK";
} on-error={
 :log warning "TODO WA: Gagal koneksi";
}

:set todoWaLock false;
